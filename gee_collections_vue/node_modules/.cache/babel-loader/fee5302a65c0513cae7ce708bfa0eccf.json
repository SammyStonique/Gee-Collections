{"ast":null,"code":"import axios from 'axios';\nexport default {\n  props: ['token', 'isAuthenticated'],\n\n  data() {\n    return {\n      email: '',\n      password: '',\n      errors: [],\n      watcherMsg: [],\n      eStyle: null\n    };\n  },\n\n  watch: {\n    email(value) {\n      // binding this to the data value in the email input  \n      this.email = value;\n      this.validateEmail(value);\n    }\n\n  },\n  methods: {\n    validateEmail(value) {\n      if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(value)) {\n        this.watcherMsg['email'] = '';\n        this.eStyle = 'green';\n      } else {\n        if (value == '') {\n          this.watcherMsg['email'] = '';\n          this.eStyle = '';\n        } else {\n          this.watcherMsg['email'] = 'Invalid Email Address';\n          this.eStyle = 'red';\n        }\n      }\n    },\n\n    userLogin() {\n      this.errors = [];\n\n      if (this.email === '' && this.password === '') {\n        this.errors.push('Please fill in the details');\n        this.$toast.error('Invalid email and password', {\n          duration: 3000\n        });\n      } else {\n        if (this.email === '') {\n          this.errors.push('Please enter your email');\n        }\n\n        if (this.password === '') {\n          this.errors.push('Please enter your password');\n        }\n      }\n\n      if (!this.errors.length) {\n        const formData = {\n          email: this.email,\n          password: this.password\n        };\n        this.axios.post('/api/v1/token/login/', formData).then(response => {\n          const token = response.data.auth_token;\n          this.$store.commit('setToken', token);\n          axios.defaults.headers.common['Authorization'] = \"Token \" + token;\n          localStorage.setItem('token', token);\n          this.$toast.success('Login Succesful', {\n            duration: 5000\n          }); // this.$store.commit('reloadingPage')\n\n          this.$router.push('/');\n          this.$store.commit('reloadingPage'); // this.$router.push('/')\n        }).catch(error => {\n          if (error.response) {\n            for (const property in error.response.data) {\n              this.errors.push(`${error.response.data[property]}`);\n            }\n\n            console.log(JSON.stringify(error.response.data));\n            this.$toast.error('Invalid Login Credentials!', {\n              duration: 5000\n            });\n          } else if (error.message) {\n            this.errors.push('Something went wrong. Please try again');\n            console.log(JSON.stringify(error));\n          }\n        });\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","props","data","email","password","errors","watcherMsg","eStyle","watch","value","validateEmail","methods","test","userLogin","push","$toast","error","duration","length","formData","post","then","response","token","auth_token","$store","commit","defaults","headers","common","localStorage","setItem","success","$router","catch","property","console","log","JSON","stringify","message"],"sourceRoot":"","sources":["/home/sammyb/gee_collections/gee_collections_vue/src/views/LoginView.vue"],"sourcesContent":["<template>\n    <div class=\"login\">\n        <!-- Breadcrumb Start -->\n        <div class=\"breadcrumb-wrap\">\n            <div class=\"container-fluid login-breadcrumb\">\n                <ul class=\"breadcrumb\">\n                    <li class=\"breadcrumb-item\"><router-link to=\"/\">Home</router-link></li>\n                    <li class=\"breadcrumb-item active\">Login</li>\n                </ul>\n            </div>\n        </div>\n        <!-- Breadcrumb End -->\n        <div class=\"login\">\n            <div class=\"container-fluid user-login-container\">\n                <div class=\"user-login-form\">\n                    <form action=\"\" @submit.prevent=\"userLogin\">\n                        <div class=\"col-md-6\">\n                            <label>Email</label>\n                            <input class=\"form-control\" type=\"email\" placeholder=\"Enter your email\" v-model=\"email\" required>\n                        </div>\n                        <div class=\"col-md-6\">\n                            <label>Password</label>\n                            <input class=\"form-control\" type=\"password\" placeholder=\"Password\" v-model=\"password\" required>\n                        </div>\n                        <div class=\"col-md-12 notification is-danger\" v-if=\"errors.length\">\n                            <p style=\"color: red;\" v-for=\"error in errors\" v-bind:key=\"error\">{{ error }}</p>\n                        </div>\n                        <div class=\"col-md-12\">\n                            <div class=\"custom-control custom-checkbox\">\n                                <input type=\"checkbox\" class=\"custom-control-input\" id=\"newaccount\">\n                                <label class=\"custom-control-label\" for=\"newaccount\">Keep me signed in</label>\n                            </div>\n                        </div>\n                        <div class=\"col-md-12\">\n                            <button class=\"btn login-btn\">Login</button>\n                        </div>\n                    </form>\n                </div>     \n            </div>\n        </div>    \n    </div>\n</template>\n\n<script>\nimport axios from 'axios'\nexport default {\n    props:['token','isAuthenticated'],\n    data(){\n        return{\n            email:'',\n            password: '',\n            errors: [],\n            watcherMsg:[],\n            eStyle: null,\n        }\n    },\n    watch:{\n        email(value){\n        // binding this to the data value in the email input  \n        this.email = value; \n        this.validateEmail(value);\n        },        \n    },\n    methods:{\n        validateEmail(value){  \n            if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(value)){ \n                this.watcherMsg['email'] = '';\n                this.eStyle = 'green'\n            } else{\n                if(value == ''){\n                    this.watcherMsg['email'] = ''; \n                    this.eStyle = ''                   \n                }\n                else{\n                    this.watcherMsg['email'] = 'Invalid Email Address'; \n                    this.eStyle = 'red'\n                }\n            }  \n        },        \n        userLogin(){\n            this.errors = [];\n            if(this.email === '' && this.password === ''){\n                this.errors.push('Please fill in the details')\n                this.$toast.error('Invalid email and password', {\n                    duration: 3000\n                })\n            }else{\n                if(this.email ===''){\n                    this.errors.push('Please enter your email')\n                }\n                if(this.password === ''){\n                    this.errors.push('Please enter your password')\n                }\n            }\n\n            if(!this.errors.length){\n                const formData = {\n                    email: this.email,\n                    password: this.password\n                }\n\n                this.axios\n                    .post('/api/v1/token/login/', formData)\n                    .then((response)=>{\n                        const token = response.data.auth_token;       \n                        this.$store.commit('setToken', token);\n                        axios.defaults.headers.common['Authorization'] = \"Token \" + token\n                        localStorage.setItem('token',token)\n                        this.$toast.success('Login Succesful',{\n                            duration: 5000\n                        })\n                        // this.$store.commit('reloadingPage')\n                        this.$router.push('/')\n                        this.$store.commit('reloadingPage')\n                        // this.$router.push('/')\n                    })    \n                    .catch((error)=>{\n                        if (error.response) {\n                            for (const property in error.response.data) {\n                                this.errors.push(`${error.response.data[property]}`)\n                            }\n                            console.log(JSON.stringify(error.response.data))\n                            this.$toast.error('Invalid Login Credentials!',{\n                                duration:5000\n                            })\n                        } else if (error.message) {\n                            this.errors.push('Something went wrong. Please try again')\n                            console.log(JSON.stringify(error))\n                        }\n                    })\n            }\n            \n        }\n    }\n}\n</script>\n\n<style scoped> \n    input{\n        font-weight: 300;\n        color: black;\n    }\n    .user-login-container{\n        width: 80%;\n    }\n    .login-breadcrumb{\n        width: 80%;\n    }\n    .login-btn{\n        width: 20%;\n    }\n    .login-form{\n        max-width: 80%;\n    }\n    input{\n        font-weight: 300;\n        color: black;\n    }\n</style>"]},"metadata":{},"sourceType":"module"}