{"ast":null,"code":"import Modal from \"@/components/Modal.vue\";\nimport LoadingView from \"@/components/LoadingView.vue\";\nlet stripe = Stripe(`YOUR_STRIPE_PUBLISHABLE_KEY`),\n    elements = stripe.elements(),\n    card = undefined;\nexport default {\n  props: [\"cartGrandTotal\", \"cartItemTotal\", \"cartSubTotal\", \"shippingCost\", \"cartTotalUSD\", 'loader', 'showLoader', 'hideLoader', 'loaderIndex', \"coupon_amount\"],\n  el: \"#selector\",\n  components: {\n    Modal,\n    LoadingView\n  },\n\n  data() {\n    return {\n      cart: {\n        cartItems: []\n      },\n      id: \"\",\n      first_name: \"\",\n      last_name: \"\",\n      email: \"\",\n      phone_number: \"\",\n      address: \"\",\n      county: \"\",\n      city: \"\",\n      town: \"\",\n      gender: \"\",\n      errors: [],\n      lipaNaMpesa: false,\n      paymentConfirm: false,\n      checked: false,\n      errors: [],\n      payment_number: \"\",\n      transaction_id: \"\",\n      isModalVisible: false,\n      mpesaRefs: [],\n      mpesaRef: \"\",\n      is_paid: false,\n      payment_ref: \"\",\n      watcherMsg: [],\n      rfStyle: null,\n      bWidth: null,\n      payment_number2: \"\",\n      pStyle: null,\n      p2Style: null,\n      isAuthenticated: false,\n      deliveryOption: false,\n      unknownVal: \"\",\n      showStripe: false,\n      coupon_amount: 0,\n      placedOrder: [],\n      placedOrderID: \"\",\n      placedOrderUser: 0\n    };\n  },\n\n  watch: {\n    mpesaRef(value) {\n      this.mpesaRef = value;\n      this.validatePaymentRef(value);\n    },\n\n    payment_number2(value) {\n      this.payment_number2 = value;\n      this.validatePhoneNumber(value);\n    },\n\n    payment_number(value) {\n      this.payment_number = value;\n      this.validatePhoneNumber2(value);\n    }\n\n  },\n  computed: {\n    setShippingCost() {\n      let shipCost = 0;\n\n      if (this.cartSubTotal == 0 || this.deliveryOption == false) {\n        this.shipCost = 0;\n      } else {\n        if (this.town == \"Bondo\" || this.town == \"Siaya\" || this.town == \"Nairobi\" || this.town == \"Ugunja\") {\n          this.shipCost = 100;\n          console.log(\"The shipping cost is \", this.shipCost);\n        } else {\n          if (this.town == \"Busia\" || this.town == \"Kiambu\" || this.town == \"Kikuyu\" || this.town == \"Kisumu\" || this.town == \"Luanda\" || this.town == \"Thika\") {\n            this.shipCost = 200;\n          } else {\n            if (this.town == \"Kakamega\") {\n              this.shipCost = 250;\n            } else {\n              if (this.town == \"Ahero\" || this.town == \"Bungoma\" || this.town == \"Machakos\" || this.town == \"Mumias\" || this.town == \"Naivasha\" || this.town == \"Nakuru\") {\n                this.shipCost = 300;\n              } else {\n                if (this.town == \"Kericho\" || this.town == \"Migori\" || this.town == \"Kitale\") {\n                  this.shipCost = 400;\n                } else {\n                  if (this.town == \"Eldoret\" || this.town == \"Embu\" || this.town == \"Kisii\" || this.town == \"Nyamira\") {\n                    this.shipCost = 500;\n                  } else {\n                    if (this.town == \"Malindi\" || this.town == \"Mombasa\" || this.town == \"Mtwapa\" || this.town == \"Ukunda\") {\n                      this.shipCost = 600;\n                    } else {\n                      this.shipCost = 0;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      return this.shipCost;\n    },\n\n    checkoutTotal() {\n      return this.cartSubTotal + this.setShippingCost;\n    }\n\n  },\n  methods: {\n    validatePaymentRef(value) {\n      if (value.length == \"\") {\n        this.watcherMsg[\"mpesaRef\"] = \"\";\n        this.rfStyle = \"\";\n        this.bWidth = 1;\n      } else {\n        if (/^[A-Z0-9]$/.test(value) && value.length > 9) {\n          this.rfStyle = \"green\";\n          this.watcherMsg[\"mpesaRef\"] = \"\";\n          this.bWidth = 2;\n        } else {\n          this.rfStyle = \"red\";\n          this.watcherMsg[\"mpesaRef\"] = \"Incomplete Reference Number\";\n          this.bWidth = 2;\n        }\n      }\n    },\n\n    validatePhoneNumber2(value) {\n      if (value == \"\") {\n        this.p2Style = \"\";\n        this.watcherMsg[\"payment_number\"] = \"\";\n      } else {\n        if (/^(?:254)?((?:(?:7(?:(?:[01249][0-9])|(?:5[789])|(?:6[89])))|(?:1(?:[1][0-5])))[0-9]{6})$/.test(value) || /^(?:254|\\+254|0)?((?:(?:7(?:(?:3[0-9])|(?:5[0-6])|(8[5-9])))|(?:1(?:[0][0-2])))[0-9]{6})$/.test(value)) {\n          this.p2Style = \"green\";\n          this.watcherMsg[\"payment_number\"] = \"\";\n          this.bWidth = 2;\n        } else {\n          this.p2Style = \"red\";\n          this.watcherMsg[\"payment_number\"] = \"Invalid Phone Number\";\n          this.bWidth = 2;\n        }\n      }\n    },\n\n    validatePhoneNumber(value) {\n      if (value == this.payment_number) {\n        this.pStyle = \"green\";\n        this.watcherMsg[\"payment_number2\"] = \"\";\n      } else {\n        this.pStyle = \"red\";\n        this.watcherMsg[\"payment_number2\"] = \"Invalid Phone Number\";\n      }\n    },\n\n    getProfileDetails() {\n      this.axios.get(\"/api/v1/users/me/\").then(response => {\n        this.phone_number = response.data.phone_number;\n        this.email = response.data.email;\n        this.id = response.data.id;\n        this.first_name = response.data.first_name;\n        this.last_name = response.data.last_name;\n        this.gender = response.data.gender;\n        this.city = response.data.city;\n        this.county = response.data.county;\n        this.address = response.data.address;\n      }).catch(error => {});\n    },\n\n    registerCallbackUrl() {\n      this.axios.get(\"/api/v1/c2b/register\").then(response => {\n        console.log(response.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    async payViaMpesa() {\n      this.errors = [];\n\n      if (this.payment_number === \"\") {\n        this.errors.push(\"Please enter phone number\");\n        this.$toast.error(\"Invalid phone number\", {\n          duration: 3000\n        });\n      }\n\n      if (!this.errors.length) {\n        let formData = {\n          payment_number: this.payment_number,\n          first_name: this.first_name,\n          orderTotal: this.checkoutTotal\n        };\n        this.showLoader();\n        this.axios.post(\"/api/v1/online/lipa/\", formData).then(response => {\n          console.log(response.data);\n          this.paymentConfirm = true;\n        }).catch(error => {\n          console.log(error);\n        }).finally(() => {\n          this.hideLoader();\n        });\n      }\n    },\n\n    getMpesaPayments() {\n      this.mpesaRefs = [];\n      this.axios.get(\"api/v1/mpesa-payments/\").then(response => {\n        for (let i = 0; i < response.data.length; i++) {\n          let trans_id = response.data[i].transaction_id;\n          this.mpesaRefs.push(trans_id);\n        }\n\n        console.log(this.mpesaRefs);\n        this.isModalVisible = true;\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    confirmPayment() {\n      if (this.mpesaRefs.includes(this.mpesaRef)) {\n        this.is_paid = true;\n        this.payment_ref = this.mpesaRef;\n        this.$toast.success(\"Payment Confirmation Succesful\", {\n          duration: 3000\n        });\n        this.placeOrder();\n      } else {\n        this.$toast.error(\"Invalid Reference Number\", {\n          duration: 3000\n        });\n      }\n    },\n\n    payViaBank() {\n      // STRIPE SETTINGS\n      let style = {\n        base: {\n          border: \"1px solid #D8D8D8\",\n          borderRadius: \"4px\",\n          color: \"#000\"\n        },\n        invalid: {// All of the error styles go inside of here.\n        }\n      };\n      let card = elements.create(\"card\", style);\n      card.mount(this.$refs.card);\n      this.showStripe = !this.showStripe;\n    },\n\n    placeOrder() {\n      this.showLoader();\n      const items = [];\n\n      for (let i = 0; i < this.cart.cartItems.length; i++) {\n        const item = this.cart.cartItems[i];\n        const obj = {\n          product: item.items.id,\n          quantity: item.quantity,\n          price: item.items.price * item.quantity\n        };\n        items.push(obj);\n      }\n\n      let formData = {\n        first_name: this.first_name,\n        last_name: this.last_name,\n        address: this.address,\n        county: this.county,\n        city: this.city,\n        phone_number: this.phone_number,\n        email: this.email,\n        items: items,\n        order_total: this.cartSubTotal,\n        payment_reference: this.payment_ref,\n        paid: this.is_paid,\n        delivery_fee: this.setShippingCost\n      };\n      this.axios.post(\"/api/v1/checkout/\", formData).then(response => {\n        this.placedOrder = response.data;\n        this.$store.commit(\"clearCart\");\n        this.$toast.success(\"Order succesfully placed\");\n        this.placedOrderID = this.placedOrder.id;\n        this.placedOrderUser = this.placedOrder.user;\n        this.$router.push(\"/\");\n        this.$store.commit(\"reloadingPage\");\n        this.$router.push(\"/\");\n      }).catch(error => {\n        console.log(error);\n      }).finally(() => {\n        this.hideLoader();\n        this.generateOrderCoupon();\n      });\n    },\n\n    generateOrderCoupon() {\n      if (this.cartSubTotal >= 10000 && this.cartSubTotal < 20000) {\n        this.coupon_amount = 500;\n      } else if (this.cartSubTotal >= 20000 && this.cartSubTotal < 30000) {\n        this.coupon_amount = 1000;\n      } else if (this.cartSubTotal >= 30000 && this.cartSubTotal < 40000) {\n        this.coupon_amount = 1500;\n      } else if (this.cartSubTotal >= 40000 && this.cartSubTotal < 50000) {\n        this.coupon_amount = 2000;\n      } else if (this.cartSubTotal >= 50000 && this.cartSubTotal < 60000) {\n        this.coupon_amount = 2500;\n      } else if (this.cartSubTotal >= 60000 && this.cartSubTotal < 70000) {\n        this.coupon_amount = 3000;\n      } else if (this.cartSubTotal >= 70000 && this.cartSubTotal < 80000) {\n        this.coupon_amount = 3500;\n      } else if (this.cartSubTotal >= 80000 && this.cartSubTotal < 90000) {\n        this.coupon_amount = 4000;\n      } else if (this.cartSubTotal >= 90000 && this.cartSubTotal < 100000) {\n        this.coupon_amount = 4500;\n      } else if (this.cartSubTotal >= 100000) {\n        this.coupon_amount = 5000;\n      } else {\n        this.coupon_amount = 0;\n      }\n\n      if (this.coupon_amount > 0) {\n        let formData = {\n          coupon_order: this.placedOrderID,\n          coupon_amount: Number(this.coupon_amount).toFixed(2),\n          activation_status: this.is_paid\n        };\n        this.axios.post(\"api/v1/generate-coupon/\", formData).then(response => {\n          console.log(\"The coupon amount is \", this.coupon_amount);\n        }).catch(error => {\n          console.log(error.message);\n        });\n      }\n    },\n\n    requestDelivery() {\n      this.deliveryOption = !this.deliveryOption;\n\n      if (this.deliveryOption == false) {\n        this.town = \"\";\n      }\n    },\n\n    showLipaNaMpesa() {\n      this.lipaNaMpesa = !this.lipaNaMpesa;\n    },\n\n    showShippingDetails() {\n      this.checked = !this.checked;\n      console.log(this.checked);\n    },\n\n    closeModal() {\n      this.isModalVisible = false;\n    },\n\n    mountPaypalButton() {},\n\n    scrollToTop() {\n      window.scrollTo({\n        top: 0,\n        behavior: \"smooth\"\n      });\n    }\n\n  },\n\n  beforeMount() {\n    this.getProfileDetails();\n    this.cart = this.$store.state.cart;\n    this.isAuthenticated = this.$store.state.isAuthenticated;\n  },\n\n  mounted() {\n    // this.registerCallbackUrl();\n    if (!this.isAuthenticated) {\n      this.$toast.error(\"You need to create an account before proceeding to checkout\");\n    }\n\n    paypal.Buttons({\n      //Styling the paypal button\n      style: {\n        color: \"blue\",\n        shape: \"pill\",\n        label: \"pay\",\n        height: 40\n      },\n      // Sets up the transaction when a payment button is clicked\n      createOrder: (data, actions) => {\n        return actions.order.create({\n          purchase_units: [{\n            amount: {\n              // value: this.cartTotalUSD // Can also reference a variable or function\n              value: 0.01\n            }\n          }]\n        });\n      },\n      // Finalize the transaction after payer approval\n      onApprove: (data, actions) => {\n        const my_action = actions.order.capture().then(function (orderData) {\n          // Successful capture! For dev/demo purposes:\n          console.log(\"Capture result\", orderData, JSON.stringify(orderData, null, 2));\n          this.transaction_id = orderData.purchase_units[0].payments.captures[0].id;\n          console.log(\"the transaction_id is:\", this.transaction_id);\n          const transaction = orderData.purchase_units[0].payments.captures[0];\n          alert(`Transaction ${transaction.status}: ${transaction.id}\\n\\nSee console for all available details`); // this.placeOrder();\n          // When ready to go live, remove the alert and show a success message within this page. For example:\n          // const element = document.getElementById('paypal-button-container');\n          // element.innerHTML = '<h3>Thank you for your payment!</h3>';\n          // Or go to another URL:  actions.redirect('thank_you.html');\n        });\n        return my_action;\n      }\n    }).render(\"#paypal-button-container\");\n  }\n\n};","map":{"version":3,"mappings":"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","names":["Modal","LoadingView","stripe","Stripe","elements","card","undefined","props","el","components","data","cart","cartItems","id","first_name","last_name","email","phone_number","address","county","city","town","gender","errors","lipaNaMpesa","paymentConfirm","checked","payment_number","transaction_id","isModalVisible","mpesaRefs","mpesaRef","is_paid","payment_ref","watcherMsg","rfStyle","bWidth","payment_number2","pStyle","p2Style","isAuthenticated","deliveryOption","unknownVal","showStripe","coupon_amount","placedOrder","placedOrderID","placedOrderUser","watch","value","validatePaymentRef","validatePhoneNumber","validatePhoneNumber2","computed","setShippingCost","shipCost","cartSubTotal","console","log","checkoutTotal","methods","length","test","getProfileDetails","axios","get","then","response","catch","error","registerCallbackUrl","payViaMpesa","push","$toast","duration","formData","orderTotal","showLoader","post","finally","hideLoader","getMpesaPayments","i","trans_id","confirmPayment","includes","success","placeOrder","payViaBank","style","base","border","borderRadius","color","invalid","create","mount","$refs","items","item","obj","product","quantity","price","order_total","payment_reference","paid","delivery_fee","$store","commit","user","$router","generateOrderCoupon","coupon_order","Number","toFixed","activation_status","message","requestDelivery","showLipaNaMpesa","showShippingDetails","closeModal","mountPaypalButton","scrollToTop","window","scrollTo","top","behavior","beforeMount","state","mounted","paypal","Buttons","shape","label","height","createOrder","actions","order","purchase_units","amount","onApprove","my_action","capture","orderData","JSON","stringify","payments","captures","transaction","alert","status","render"],"sourceRoot":"","sources":["/home/sammyb/gee_collections/gee_collections_vue/src/views/CheckoutView.vue"],"sourcesContent":["<template>\n\n  <!-- Loading Animation for Printing Invoice -->\n  <LoadingView\n    :loader=\"loader\"\n    :showLoader=\"showLoader\"\n    :hideLoader=\"hideLoader\"\n  />\n\n  <div class=\"checkout\" :style=\"{zIndex: this.loaderIndex}\">\n    <!-- Breadcrumb Start -->\n    <div class=\"breadcrumb-wrap\">\n      <div class=\"container-fluid\">\n        <ul class=\"breadcrumb\">\n          <li class=\"breadcrumb-item\"><router-link to=\"/\">Home</router-link></li>\n          <li class=\"breadcrumb-item\"><router-link to=\"/cart\">Cart</router-link></li>\n          <li class=\"breadcrumb-item active\">Checkout</li>\n        </ul>\n      </div>\n    </div>\n    <!-- Breadcrumb End -->\n\n    <!-- Checkout Start -->\n    <div class=\"checkout\">\n      <div class=\"container-fluid\">\n        <form action=\"\" @submit.prevent=\"placeOrder\">\n          <div class=\"row\">\n            <div class=\"col-lg-8\">\n              <div class=\"checkout-inner\">\n                <div class=\"billing-address\">\n                  <h2>Billing Address</h2>\n                  <div class=\"row\">\n                    <div class=\"col-md-6\">\n                      <label>First Name</label>\n                      <input\n                        class=\"form-control\"\n                        type=\"text\"\n                        placeholder=\"First Name\"\n                        v-model=\"first_name\"\n                      />\n                    </div>\n                    <div class=\"col-md-6\">\n                      <label>Last Name</label>\n                      <input\n                        class=\"form-control\"\n                        type=\"text\"\n                        placeholder=\"Last Name\"\n                        v-model=\"last_name\"\n                      />\n                    </div>\n                    <div class=\"col-md-6\">\n                      <label>E-mail</label>\n                      <input\n                        class=\"form-control\"\n                        type=\"email\"\n                        placeholder=\"Email\"\n                        v-model=\"email\"\n                        disabled=\"true\"\n                      />\n                    </div>\n                    <div class=\"col-md-6\">\n                      <label>Mobile No</label>\n                      <input\n                        class=\"form-control\"\n                        type=\"text\"\n                        placeholder=\"Mobile\"\n                        v-model=\"phone_number\"\n                      />\n                    </div>\n                    <div class=\"col-md-6\">\n                      <label>Gender</label>\n                      <select name=\"gender\" class=\"form-control\" v-model=\"gender\">\n                        <option value=\"\" disabled=\"true\">--Select your Gender--</option>\n                        <option>Male</option>\n                        <option>Female</option>\n                        <option>Other</option>\n                      </select>\n                    </div>\n                    <div class=\"col-md-6\">\n                      <label>Address</label>\n                      <input\n                        class=\"form-control\"\n                        type=\"text\"\n                        placeholder=\"Address\"\n                        v-model=\"address\"\n                      />\n                    </div>\n                    <div class=\"col-md-6\">\n                      <label>City</label>\n                      <select name=\"city\" class=\"form-control\" v-model=\"city\">\n                        <option value=\"\" disabled=\"true\">--Select your City--</option>\n                        <option>Nairobi</option>\n                        <option>Kisumu</option>\n                        <option>Mombasa</option>\n                        <option>Nakuru</option>\n                      </select>\n                    </div>\n                    <div class=\"col-md-6\">\n                      <label>County</label>\n                      <select name=\"county\" class=\"form-control\" v-model=\"county\">\n                        <option value=\"\" disabled=\"true\">--Select your County--</option>\n                        <option>Siaya</option>\n                        <option>Kisumu</option>\n                        <option>Nairobi</option>\n                        <option>Mombasa</option>\n                      </select>\n                    </div>\n                    <div class=\"col-md-12\">\n                      <div class=\"custom-control custom-checkbox\">\n                        <input\n                          type=\"checkbox\"\n                          class=\"custom-control-input\"\n                          id=\"newaccount\"\n                          @click=\"requestDelivery()\"\n                        />\n                        <label class=\"custom-control-label\" for=\"newaccount\"\n                          >Select if you would wish for the items to be delivered</label\n                        >\n                        <div class=\"delivery-address\" v-if=\"deliveryOption\">\n                          <br /><br />\n                          <h5>Delivery Address</h5>\n                          <div class=\"row\">\n                            <div class=\"col-md-6\">\n                              <label>Choose the delivery town</label>\n                              <select name=\"town\" class=\"form-control\" v-model=\"town\">\n                                <option value=\"\" disabled=\"true\">\n                                  --Select your Town--\n                                </option>\n                                <option>Ahero</option>\n                                <option>Bondo</option>\n                                <option>Bungoma</option>\n                                <option>Busia</option>\n                                <option>Eldoret</option>\n                                <option>Embu</option>\n                                <option>Kakamega</option>\n                                <option>Kericho</option>\n                                <option>Kiambu</option>\n                                <option>Kikuyu</option>\n                                <option>Kisii</option>\n                                <option>Kisumu</option>\n                                <option>Kitale</option>\n                                <option>Luanda</option>\n                                <option>Machakos</option>\n                                <option>Malindi</option>\n                                <option>Migori</option>\n                                <option>Mombasa</option>\n                                <option>Mtwapa</option>\n                                <option>Mumias</option>\n                                <option>Nairobi</option>\n                                <option>Naivasha</option>\n                                <option>Nakuru</option>\n                                <option>Nyamira</option>\n                                <option>Siaya</option>\n                                <option>Thika</option>\n                                <option>Ugunja</option>\n                                <option>Ukunda</option>\n                              </select>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div class=\"col-md-12\">\n                      <div class=\"custom-control custom-checkbox\">\n                        <input\n                          type=\"checkbox\"\n                          class=\"custom-control-input\"\n                          id=\"shipto\"\n                          @click=\"showShippingDetails\"\n                        />\n                        <label class=\"custom-control-label\" for=\"shipto\"\n                          >Ship to different address</label\n                        >\n                        <div class=\"shipping-address\" v-if=\"checked\">\n                          <h2>Shipping Address</h2>\n                          <div class=\"row\">\n                            <div class=\"col-md-6\">\n                              <label>First Name</label>\n                              <input\n                                class=\"form-control\"\n                                type=\"text\"\n                                placeholder=\"First Name\"\n                              />\n                            </div>\n                            <div class=\"col-md-6\">\n                              <label>Last Name</label>\n                              <input\n                                class=\"form-control\"\n                                type=\"text\"\n                                placeholder=\"Last Name\"\n                              />\n                            </div>\n                            <div class=\"col-md-6\">\n                              <label>E-mail</label>\n                              <input\n                                class=\"form-control\"\n                                type=\"text\"\n                                placeholder=\"E-mail\"\n                              />\n                            </div>\n                            <div class=\"col-md-6\">\n                              <label>Mobile No</label>\n                              <input\n                                class=\"form-control\"\n                                type=\"text\"\n                                placeholder=\"Mobile No\"\n                              />\n                            </div>\n                            <div class=\"col-md-12\">\n                              <label>Address</label>\n                              <input\n                                class=\"form-control\"\n                                type=\"text\"\n                                placeholder=\"Address\"\n                              />\n                            </div>\n                            <div class=\"col-md-6\">\n                              <label>Country</label>\n                              <select class=\"custom-select\">\n                                <option selected>Kenya</option>\n                                <option>Tanzania</option>\n                                <option>Uganda</option>\n                                <option>Rwanda</option>\n                              </select>\n                            </div>\n                            <div class=\"col-md-6\">\n                              <label>City</label>\n                              <input\n                                class=\"form-control\"\n                                type=\"text\"\n                                placeholder=\"City\"\n                              />\n                            </div>\n                            <div class=\"col-md-6\">\n                              <label>County</label>\n                              <input\n                                class=\"form-control\"\n                                type=\"text\"\n                                placeholder=\"County\"\n                              />\n                            </div>\n                            <div class=\"col-md-6\">\n                              <label>ZIP Code</label>\n                              <input\n                                class=\"form-control\"\n                                type=\"text\"\n                                placeholder=\"ZIP Code\"\n                              />\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class=\"col-lg-4\">\n              <div class=\"checkout-inner\">\n                <div class=\"checkout-summary\">\n                  <h1>Cart Total</h1>\n                  <p class=\"sub-total\">\n                    Sub Total<span>ksh. {{ Number(cartSubTotal).toLocaleString() }}</span>\n                  </p>\n                  <p class=\"ship-cost\">\n                    Delivery Fee<span\n                      >ksh. {{ Number(setShippingCost).toLocaleString() }}</span\n                    >\n                  </p>\n                  <p class=\"\">\n                        Coupon Applied<span\n                          >ksh. {{ Number(coupon_amount).toLocaleString() }}</span\n                        >\n                      </p>\n                  <h2>\n                    Grand Total<span>{{ Number(checkoutTotal).toLocaleString() }}</span>\n                  </h2>\n                </div>\n\n                <div class=\"checkout-payment\">\n                  <h1>Payment Methods</h1>\n                  <button type=\"button\" class=\"lipanampesa\" @click=\"showLipaNaMpesa\">\n                    Lipa Na Mpesa\n                  </button>\n                  <div v-if=\"lipaNaMpesa\">\n                    <p>\n                      To proceed to Lipa Na Mpesa, please enter the phone number you would\n                      like to make the payment with.\n                    </p>\n                    <label for=\"\">Phone Number:</label>\n                    <input\n                      type=\"text\"\n                      class=\"form-control\"\n                      placeholder=\"e.g 2547XXXXXXXX\"\n                      v-model=\"payment_number\"\n                      :style=\"{ borderColor: p2Style, borderWidth: bWidth + 'px' }\"\n                    />\n                    <span\n                      v-if=\"watcherMsg.payment_number\"\n                      :style=\"{ color: p2Style, fontSize: 10 + 'px' }\"\n                      >{{ watcherMsg.payment_number }}</span\n                    >\n                    <div class=\"col-md-12 notification is-danger\" v-if=\"errors.length\">\n                      <p style=\"color: red\" v-for=\"error in errors\" v-bind:key=\"error\">\n                        {{ error }}\n                      </p>\n                    </div>\n                    <button type=\"button\" class=\"procPayBtn\" @click=\"payViaMpesa\">\n                      Proceed to Pay\n                    </button>\n                    <p v-if=\"paymentConfirm\">\n                      An mpesa prompt has been sent to the number entered above,enter your\n                      mpesa PIN then proceed to payment confirmation\n                    </p>\n                    <button\n                      type=\"button\"\n                      class=\"procPayBtn\"\n                      @click=\"getMpesaPayments\"\n                      v-if=\"paymentConfirm\"\n                    >\n                      Confirm Payment\n                    </button>\n                  </div>\n\n                  <!-- MODAL component for confirming payment -->\n                  <Modal v-show=\"isModalVisible\" @close=\"closeModal\">\n                    <template v-slot:header> M-Pesa Payment Confirmation </template>\n\n                    <template v-slot:body>\n                      <div>\n                        <p>\n                          Please confirm the details of your payments to succesfully place\n                          your order\n                        </p>\n                        <label for=\"\">Phone Number:</label>\n                        <input\n                          type=\"text\"\n                          class=\"form-control\"\n                          placeholder=\"e.g 2547XXXXXXXX\"\n                          :style=\"{ borderColor: pStyle, borderWidth: bWidth + 'px' }\"\n                        />\n                        <span\n                          v-if=\"watcherMsg.payment_number2\"\n                          :style=\"{ color: pStyle, fontSize: 10 + 'px' }\"\n                          >{{ watcherMsg.payment_number2 }}</span\n                        >\n                        <label for=\"\">Reference Number:</label>\n                        <input\n                          type=\"text\"\n                          class=\"form-control\"\n                          placeholder=\"e.g QRYU0U***P1\"\n                          v-model=\"mpesaRef\"\n                          :style=\"{ borderColor: rfStyle, borderWidth: bWidth + 'px' }\"\n                        />\n                        <span\n                          v-if=\"watcherMsg.mpesaRef\"\n                          :style=\"{ color: rfStyle, fontSize: 10 + 'px' }\"\n                          >{{ watcherMsg.mpesaRef }}</span\n                        >\n                        <button type=\"button\" class=\"procPayBtn\" @click=\"confirmPayment\">\n                          Confirm Payment\n                        </button>\n                      </div>\n                    </template>\n\n                    <template v-slot:footer>\n                      Thank you for doing business with us.\n                    </template>\n                  </Modal>\n                  <div id=\"paypal-button-container\"></div>\n                  <div>\n                    <button\n                      class=\"lipanabank bg-yellow-400 hover:text-yellow-400 hover:bg-black\"\n                      type=\"button\"\n                      @click=\"payViaBank\"\n                    >\n                      Pay Via Bank\n                    </button>\n                  </div>\n                  <div v-if=\"showStripe\" ref=\"card\"></div>\n                  <div class=\"checkout-btn\">\n                    <button type=\"submit\">Place Order</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n    <!-- Checkout End -->\n  </div>\n</template>\n\n<script>\nimport Modal from \"@/components/Modal.vue\";\nimport LoadingView from \"@/components/LoadingView.vue\"\n\nlet stripe = Stripe(`YOUR_STRIPE_PUBLISHABLE_KEY`),\n  elements = stripe.elements(),\n  card = undefined;\nexport default {\n  props: [\n    \"cartGrandTotal\",\n    \"cartItemTotal\",\n    \"cartSubTotal\",\n    \"shippingCost\",\n    \"cartTotalUSD\",\n    'loader','showLoader','hideLoader','loaderIndex',\n    \"coupon_amount\"\n  ],\n  el: \"#selector\",\n  components: {\n    Modal,\n    LoadingView\n  },\n  data() {\n    return {\n      cart: {\n        cartItems: [],\n      },\n      id: \"\",\n      first_name: \"\",\n      last_name: \"\",\n      email: \"\",\n      phone_number: \"\",\n      address: \"\",\n      county: \"\",\n      city: \"\",\n      town: \"\",\n      gender: \"\",\n      errors: [],\n      lipaNaMpesa: false,\n      paymentConfirm: false,\n      checked: false,\n      errors: [],\n      payment_number: \"\",\n      transaction_id: \"\",\n      isModalVisible: false,\n      mpesaRefs: [],\n      mpesaRef: \"\",\n      is_paid: false,\n      payment_ref: \"\",\n      watcherMsg: [],\n      rfStyle: null,\n      bWidth: null,\n      payment_number2: \"\",\n      pStyle: null,\n      p2Style: null,\n      isAuthenticated: false,\n      deliveryOption: false,\n      unknownVal: \"\",\n      showStripe: false,\n      coupon_amount: 0,\n      placedOrder: [],\n      placedOrderID: \"\",\n      placedOrderUser: 0,\n    };\n  },\n  watch: {\n    mpesaRef(value) {\n      this.mpesaRef = value;\n      this.validatePaymentRef(value);\n    },\n    payment_number2(value) {\n      this.payment_number2 = value;\n      this.validatePhoneNumber(value);\n    },\n    payment_number(value) {\n      this.payment_number = value;\n      this.validatePhoneNumber2(value);\n    },\n  },\n  computed: {\n    setShippingCost() {\n      let shipCost = 0;\n      if (this.cartSubTotal == 0 || this.deliveryOption == false) {\n        this.shipCost = 0;\n      } else {\n        if (\n          this.town == \"Bondo\" ||\n          this.town == \"Siaya\" ||\n          this.town == \"Nairobi\" ||\n          this.town == \"Ugunja\"\n        ) {\n          this.shipCost = 100;\n          console.log(\"The shipping cost is \", this.shipCost);\n        } else {\n          if (\n            this.town == \"Busia\" ||\n            this.town == \"Kiambu\" ||\n            this.town == \"Kikuyu\" ||\n            this.town == \"Kisumu\" ||\n            this.town == \"Luanda\" ||\n            this.town == \"Thika\"\n          ) {\n            this.shipCost = 200;\n          } else {\n            if (this.town == \"Kakamega\") {\n              this.shipCost = 250;\n            } else {\n              if (\n                this.town == \"Ahero\" ||\n                this.town == \"Bungoma\" ||\n                this.town == \"Machakos\" ||\n                this.town == \"Mumias\" ||\n                this.town == \"Naivasha\" ||\n                this.town == \"Nakuru\"\n              ) {\n                this.shipCost = 300;\n              } else {\n                if (\n                  this.town == \"Kericho\" ||\n                  this.town == \"Migori\" ||\n                  this.town == \"Kitale\"\n                ) {\n                  this.shipCost = 400;\n                } else {\n                  if (\n                    this.town == \"Eldoret\" ||\n                    this.town == \"Embu\" ||\n                    this.town == \"Kisii\" ||\n                    this.town == \"Nyamira\"\n                  ) {\n                    this.shipCost = 500;\n                  } else {\n                    if (\n                      this.town == \"Malindi\" ||\n                      this.town == \"Mombasa\" ||\n                      this.town == \"Mtwapa\" ||\n                      this.town == \"Ukunda\"\n                    ) {\n                      this.shipCost = 600;\n                    } else {\n                      this.shipCost = 0;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      return this.shipCost;\n    },\n    checkoutTotal() {\n      return this.cartSubTotal + this.setShippingCost;\n    },\n  },\n  methods: {\n    validatePaymentRef(value) {\n      if (value.length == \"\") {\n        this.watcherMsg[\"mpesaRef\"] = \"\";\n        this.rfStyle = \"\";\n        this.bWidth = 1;\n      } else {\n        if (/^[A-Z0-9]$/.test(value) && value.length > 9) {\n          this.rfStyle = \"green\";\n          this.watcherMsg[\"mpesaRef\"] = \"\";\n          this.bWidth = 2;\n        } else {\n          this.rfStyle = \"red\";\n          this.watcherMsg[\"mpesaRef\"] = \"Incomplete Reference Number\";\n          this.bWidth = 2;\n        }\n      }\n    },\n    validatePhoneNumber2(value) {\n      if (value == \"\") {\n        this.p2Style = \"\";\n        this.watcherMsg[\"payment_number\"] = \"\";\n      } else {\n        if (\n          /^(?:254)?((?:(?:7(?:(?:[01249][0-9])|(?:5[789])|(?:6[89])))|(?:1(?:[1][0-5])))[0-9]{6})$/.test(\n            value\n          ) ||\n          /^(?:254|\\+254|0)?((?:(?:7(?:(?:3[0-9])|(?:5[0-6])|(8[5-9])))|(?:1(?:[0][0-2])))[0-9]{6})$/.test(\n            value\n          )\n        ) {\n          this.p2Style = \"green\";\n          this.watcherMsg[\"payment_number\"] = \"\";\n          this.bWidth = 2;\n        } else {\n          this.p2Style = \"red\";\n          this.watcherMsg[\"payment_number\"] = \"Invalid Phone Number\";\n          this.bWidth = 2;\n        }\n      }\n    },\n    validatePhoneNumber(value) {\n      if (value == this.payment_number) {\n        this.pStyle = \"green\";\n        this.watcherMsg[\"payment_number2\"] = \"\";\n      } else {\n        this.pStyle = \"red\";\n        this.watcherMsg[\"payment_number2\"] = \"Invalid Phone Number\";\n      }\n    },\n    getProfileDetails() {\n      this.axios\n        .get(\"/api/v1/users/me/\")\n        .then((response) => {\n          this.phone_number = response.data.phone_number;\n          this.email = response.data.email;\n          this.id = response.data.id;\n          this.first_name = response.data.first_name;\n          this.last_name = response.data.last_name;\n          this.gender = response.data.gender;\n          this.city = response.data.city;\n          this.county = response.data.county;\n          this.address = response.data.address;\n        })\n        .catch((error) => {});\n    },\n    registerCallbackUrl() {\n      this.axios\n        .get(\"/api/v1/c2b/register\")\n        .then((response) => {\n          console.log(response.data);\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    },\n    async payViaMpesa() {\n      this.errors = [];\n      if (this.payment_number === \"\") {\n        this.errors.push(\"Please enter phone number\");\n        this.$toast.error(\"Invalid phone number\", {\n          duration: 3000,\n        });\n      }\n      if (!this.errors.length) {\n        let formData = {\n          payment_number: this.payment_number,\n          first_name: this.first_name,\n          orderTotal: this.checkoutTotal,\n        };\n        this.showLoader();\n        this.axios\n          .post(\"/api/v1/online/lipa/\", formData)\n          .then((response) => {\n            console.log(response.data);\n            this.paymentConfirm = true;\n          })\n          .catch((error) => {\n            console.log(error);\n          })\n          .finally(() => {\n            this.hideLoader();\n          });\n      }\n    },\n\n    getMpesaPayments() {\n      this.mpesaRefs = [];\n      this.axios\n        .get(\"api/v1/mpesa-payments/\")\n        .then((response) => {\n          for (let i = 0; i < response.data.length; i++) {\n            let trans_id = response.data[i].transaction_id;\n            this.mpesaRefs.push(trans_id);\n          }\n          console.log(this.mpesaRefs);\n          this.isModalVisible = true;\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    },\n    confirmPayment() {\n      if (this.mpesaRefs.includes(this.mpesaRef)) {\n        this.is_paid = true;\n        this.payment_ref = this.mpesaRef;\n        this.$toast.success(\"Payment Confirmation Succesful\", {\n          duration: 3000,\n        });\n        this.placeOrder();\n      } else {\n        this.$toast.error(\"Invalid Reference Number\", {\n          duration: 3000,\n        });\n      }\n    },\n    payViaBank() {\n      // STRIPE SETTINGS\n      let style = {\n        base: {\n          border: \"1px solid #D8D8D8\",\n          borderRadius: \"4px\",\n          color: \"#000\",\n        },\n\n        invalid: {\n          // All of the error styles go inside of here.\n        },\n      };\n      let card = elements.create(\"card\", style);\n      card.mount(this.$refs.card);\n      this.showStripe = !this.showStripe;\n    },\n    placeOrder() {\n      this.showLoader();\n      const items = [];\n      for (let i = 0; i < this.cart.cartItems.length; i++) {\n        const item = this.cart.cartItems[i];\n        const obj = {\n          product: item.items.id,\n          quantity: item.quantity,\n          price: item.items.price * item.quantity,\n        };\n        items.push(obj);\n      }\n      let formData = {\n        first_name: this.first_name,\n        last_name: this.last_name,\n        address: this.address,\n        county: this.county,\n        city: this.city,\n        phone_number: this.phone_number,\n        email: this.email,\n        items: items,\n        order_total: this.cartSubTotal,\n        payment_reference: this.payment_ref,\n        paid: this.is_paid,\n        delivery_fee: this.setShippingCost,\n      };\n      this.axios\n        .post(\"/api/v1/checkout/\", formData)\n        .then((response) => {\n          this.placedOrder = response.data;\n          this.$store.commit(\"clearCart\");\n          this.$toast.success(\"Order succesfully placed\");\n          this.placedOrderID = this.placedOrder.id;\n          this.placedOrderUser = this.placedOrder.user;\n          this.$router.push(\"/\");\n          this.$store.commit(\"reloadingPage\");\n          this.$router.push(\"/\");\n        })\n        .catch((error) => {\n          console.log(error);\n        })\n        .finally(()=>{\n          this.hideLoader();\n          this.generateOrderCoupon();\n        });\n    },\n    generateOrderCoupon(){\n      if (this.cartSubTotal >= 10000 && this.cartSubTotal < 20000){\n          this.coupon_amount = 500;\n        }else if(this.cartSubTotal >= 20000 && this.cartSubTotal < 30000){\n          this.coupon_amount = 1000;\n        }else if(this.cartSubTotal >= 30000 && this.cartSubTotal < 40000){\n          this.coupon_amount = 1500;\n        }else if(this.cartSubTotal >= 40000 && this.cartSubTotal < 50000){\n          this.coupon_amount = 2000;\n        }else if(this.cartSubTotal >= 50000 && this.cartSubTotal < 60000){\n          this.coupon_amount = 2500;\n        }else if(this.cartSubTotal >= 60000 && this.cartSubTotal < 70000){\n          this.coupon_amount = 3000;\n        }else if(this.cartSubTotal >= 70000 && this.cartSubTotal < 80000){\n          this.coupon_amount = 3500;\n        }else if(this.cartSubTotal >= 80000 && this.cartSubTotal < 90000){\n          this.coupon_amount = 4000;\n        }else if(this.cartSubTotal >= 90000 && this.cartSubTotal < 100000){\n          this.coupon_amount = 4500;\n        }else if(this.cartSubTotal >= 100000){\n          this.coupon_amount = 5000;\n        }else{\n          this.coupon_amount = 0;\n        }\n        if(this.coupon_amount > 0){\n          let formData = {\n            coupon_order: this.placedOrderID,\n            coupon_amount: Number(this.coupon_amount).toFixed(2),\n            activation_status: this.is_paid,\n          };\n          this.axios.post(\"api/v1/generate-coupon/\",formData)\n          .then((response)=>{\n            console.log(\"The coupon amount is \",this.coupon_amount)\n          })\n          .catch((error)=>{\n            console.log(error.message);\n          })\n        }\n      \n    },\n    requestDelivery() {\n      this.deliveryOption = !this.deliveryOption;\n      if (this.deliveryOption == false) {\n        this.town = \"\";\n      }\n    },\n    showLipaNaMpesa() {\n      this.lipaNaMpesa = !this.lipaNaMpesa;\n    },\n    showShippingDetails() {\n      this.checked = !this.checked;\n      console.log(this.checked);\n    },\n    closeModal() {\n      this.isModalVisible = false;\n    },\n    mountPaypalButton() {},\n    scrollToTop() {\n      window.scrollTo({ top: 0, behavior: \"smooth\" });\n    },\n  },\n  beforeMount() {\n    this.getProfileDetails();\n    this.cart = this.$store.state.cart;\n    this.isAuthenticated = this.$store.state.isAuthenticated;\n  },\n  mounted() {\n    // this.registerCallbackUrl();\n    if (!this.isAuthenticated) {\n      this.$toast.error(\"You need to create an account before proceeding to checkout\");\n    }\n\n    paypal\n      .Buttons({\n        //Styling the paypal button\n        style: {\n          color: \"blue\",\n          shape: \"pill\",\n          label: \"pay\",\n          height: 40,\n        },\n        // Sets up the transaction when a payment button is clicked\n        createOrder: (data, actions) => {\n          return actions.order.create({\n            purchase_units: [\n              {\n                amount: {\n                  // value: this.cartTotalUSD // Can also reference a variable or function\n                  value: 0.01,\n                },\n              },\n            ],\n          });\n        },\n        // Finalize the transaction after payer approval\n        onApprove: (data, actions) => {\n          const my_action = actions.order.capture().then(function (orderData) {\n            // Successful capture! For dev/demo purposes:\n            console.log(\"Capture result\", orderData, JSON.stringify(orderData, null, 2));\n            this.transaction_id = orderData.purchase_units[0].payments.captures[0].id;\n            console.log(\"the transaction_id is:\", this.transaction_id);\n\n            const transaction = orderData.purchase_units[0].payments.captures[0];\n            alert(\n              `Transaction ${transaction.status}: ${transaction.id}\\n\\nSee console for all available details`\n            );\n\n            // this.placeOrder();\n            // When ready to go live, remove the alert and show a success message within this page. For example:\n            // const element = document.getElementById('paypal-button-container');\n            // element.innerHTML = '<h3>Thank you for your payment!</h3>';\n            // Or go to another URL:  actions.redirect('thank_you.html');\n          });\n          return my_action;\n        },\n      })\n      .render(\"#paypal-button-container\");\n  },\n};\n</script>\n\n<style scoped>\ninput {\n  font-weight: 300;\n  color: black;\n}\nselect {\n  font-weight: 300;\n  color: black;\n}\n.lipanampesa {\n  width: 100%;\n  height: 40px;\n  padding: 2px 10px;\n  font-family: \"Source Code Pro\", monospace;\n  font-weight: 700;\n  font-size: 18px;\n  text-align: center;\n  color: #000000;\n  background: #228b22;\n  border: none;\n  transition: all 0.3s;\n  margin-bottom: 20px;\n  border-radius: 20px;\n}\n.lipanampesa:hover {\n  background-color: black;\n  color: green;\n}\n.lipanabank {\n  width: 100%;\n  height: 40px;\n  padding: 2px 10px;\n  font-family: \"Source Code Pro\", monospace;\n  font-weight: 700;\n  font-size: 18px;\n  text-align: center;\n  color: #000000;\n  /* background: yellow; */\n  border: none;\n  transition: all 0.3s;\n  margin-bottom: 20px;\n  border-radius: 20px;\n}\n.procPayBtn {\n  margin: 20px;\n  color: #228b22;\n  background-color: black;\n  border: none;\n  border-radius: 4px;\n  transition: all 0.3s;\n  font-weight: 700;\n  font-size: 18px;\n}\n.procPayBtn:hover {\n  color: white;\n  background-color: green;\n}\n.delivery-address h5 {\n  font-family: \"Source Code Pro\", monospace;\n  font-weight: bold;\n  font-size: 18px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}